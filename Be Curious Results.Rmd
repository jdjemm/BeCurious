---
title: "Be Curious Results"
author: "Leeds Clinical Trials Research Unit"
date: "07/05/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overall

This is a bar chart. It shows us all the data from the different people we surveyed at Be Curious this year. The chart can give us an early idea on whether there might be a link between the chocolate groups and the different levels of happiness.

Do you think there might be a link? Is everyone very happy? Are more people happy in Group A or Group B? Or are there a mix of answers?

```{r overall, echo=FALSE}
data<-read.csv('Be curious 2022 participant data.csv')
data$Colour<-as.factor(data$Colour)
data$Group<-as.factor(data$Group)
data$How.Happy.Are.You.<-factor(data$How.Happy.Are.You., ordered=TRUE, labels=c("Not Happy","Happy","Very Happy"))

OverallPlotData <- data.frame(table(data$Group, data$How.Happy.Are.You.))
colnames(OverallPlotData) <- c("Chocolate Group", "Happy", "Freq")

library(ggplot2)
library(scales)
library(grid)
library(gridExtra)
library(tidyr)

OverallPlot <- ggplot(OverallPlotData, aes(fill=`Chocolate Group`, x=Happy, y=Freq)) + 
  geom_bar(position="dodge", stat="identity") + theme_minimal() + theme(plot.title = element_text(size = 12,hjust=0.5)) +
  scale_fill_brewer(palette="Paired") + 
  geom_text(aes(label=Freq), vjust=1.6, color="white", position = position_dodge(0.9), size=3.5) +
  labs(title="Current Happiness by Chocolate Groups", x="Current Happiness", y="Number of Participants")


tt3 <- ttheme_minimal(
  core=list(bg_params = list(fill = blues9[1:4], col=NA),
            fg_params=list(fontface=3)),
  colhead=list(bg_params = list(fill = "navyblue", col=NA),
               fg_params=list(col="white", fontface=4L)),
  rowhead=list(fg_params=list(col="white", fontface=3L)))

table<-spread(OverallPlotData,key=Happy,value=Freq)
table[,5]<-rowSums(table[,2:4])
colnames(table)[5]<-"Total"
tbl <- tableGrob(table, theme=tt3)


grid.arrange(OverallPlot, tbl,
             nrow = 2,
             heights = c(1, 0.5))
```

Wasn't sure whether to have shiny element here so you could look at by colour group but don't know how to write this up, feel free to include if you know!

```{r pressure, echo=FALSE}

```

We can also carry out a statistical test to help us decide if there might be a link (or association) between chocolate group and happiness. From the people we asked at Be Curious, our results were...

```{r echo=FALSE}
chisq <- chisq.test(table(data$Group, data$How.Happy.Are.You.))
fishers <- fisher.test(table(data$Group, data$How.Happy.Are.You.))

if(chisq$expected[1,1] < 5 || chisq$expected[1,2] < 5 || chisq$expected[1,3] < 5 || chisq$expected[2,1] < 5 || chisq$expected[2,2] < 5 || chisq$expected[2,3] < 5){
  if(fishers$p.value<0.05){ans <- "Fishers Test: Happiness and Chocolate Group are not independent"}
  else{ans <- "Fishers Test: Happiness and Chocolate Group are independent"}
  
}else{
  if(chisq$p.value<0.05){ans <- "Chi-Squared Test: Happiness and Chocolate Group are not independent"}
  else{ans <- "Chi-Squared Test: Happiness and Chocolate Group are independent"}
}
ans
```
#!DELETE ONE OF THESE ACCORDING TO THE RESULT!

This means that there is not enough evidence to say that one chocolate group makes people happier than another. How did this compare to your thoughts from looking at the bar charts?

This means there is evidence to say that there is a difference in how happy the two chocolate groups make people. How did this compare to your thoughts from looking at the bar charts?

#!DO NOT DELETE FROM HERE!
The issue from this test is that if we find the chocolate group to be independent, we don't know which group makes people happier than the other, all we would know is that there is a difference. We may also want to know whether there is a difference in peoples' answers based on their age, happiness before eating chocolate or their chocolate preferences.

We can find out the answers to all of these questions too!

