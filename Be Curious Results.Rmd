---
title: "Be Curious Results"
author: "Leeds Clinical Trials Research Unit"
date: "07/05/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Overall

This is a bar chart. It shows us all the data from the different people we surveyed at Be Curious this year. The chart can give us an early idea on whether there might be a link between the chocolate groups and the different levels of happiness.

Do you think there might be a link? Is everyone very happy? Are more people happy in Group A or Group B? Or are there a mix of answers?

```{r overall, echo=FALSE}
data<-read.csv('Be curious 2022 participant data.csv')
data$Colour<-as.factor(data$Colour)
data$Group<-as.factor(data$Group)
data$How.Happy.Are.You.<-factor(data$How.Happy.Are.You., ordered=TRUE, labels=c("Not Happy","Happy","Very Happy"))

OverallPlotData <- data.frame(table(data$Group, data$How.Happy.Are.You.))
colnames(OverallPlotData) <- c("Chocolate Group", "Happy", "Freq")

library(ggplot2)
library(scales)
library(grid)
library(gridExtra)
library(tidyr)

OverallPlot <- ggplot(OverallPlotData, aes(fill=`Chocolate Group`, x=Happy, y=Freq)) + 
  geom_bar(position="dodge", stat="identity") + theme_minimal() + theme(plot.title = element_text(size = 12,hjust=0.5)) +
  scale_fill_brewer(palette="Paired") + 
  geom_text(aes(label=Freq), vjust=1.6, color="white", position = position_dodge(0.9), size=3.5) +
  labs(title="Current Happiness by Chocolate Groups", x="Current Happiness", y="Number of Participants")


tt3 <- ttheme_minimal(
  core=list(bg_params = list(fill = blues9[1:4], col=NA),
            fg_params=list(fontface=3)),
  colhead=list(bg_params = list(fill = "navyblue", col=NA),
               fg_params=list(col="white", fontface=4L)),
  rowhead=list(fg_params=list(col="white", fontface=3L)))

table<-spread(OverallPlotData,key=Happy,value=Freq)
tbl <- tableGrob(table, theme=tt3)
grid.arrange(OverallPlot, tbl,
             nrow = 2,
             heights = c(1, 0.5))
```




```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
