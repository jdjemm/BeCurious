if(df[58,8]=="YES"){
des[1,10] <- "Adenocarcinoma"
}
if(is.na(df[59,8])==F){
des[1,10] <- df[59,8]
}
if(df[61,8]=="YES"){
des[1,11] <- "Well"
}
if(df[62,8]=="YES"){
des[1,11] <- "Moderate"
}
if(df[63,8]=="YES"){
des[1,11] <- "Poor"
}
des[1,12] <-
des[1,13] <- df[101,8]
des[1,14] <- df[102,8]
for(i in 1:5){
if(isTRUE(df[132+i,8]=="Yes")){
des[1,15]<-i
}
}
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
library(readxl)
library(openxlsx)
library(tidyverse)
df <- read_xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")[,c(1,3:9)]
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
des[1,1] <- df[2,8]
des[1,2] <- paste("UGI-",df[1,8],sep="")
des[1,3] <- df[7,8]
if(df[11,8]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[12,8]=="YES"){
des[1,4] <- "Total oesophagectomy"
}
if(df[13,8]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
if(df[14,8]=="YES"){
des[1,4] <- "Unknown"
}
des[1,5] <- df[20,8]
des[1,6] <- df[21,8]
if(df[28,8]=="YES"){
des[1,7] <- "Entire circumference"
}
if(df[29,8]=="YES"){
des[1,7] <- "Anterior/Posterior"
}
if(df[30,8]=="YES"){
des[1,7] <- "Right/left"
}
if(df[31,8]=="YES"){
des[1,7] <- "Unknown"
}
des[1,8] <- df[37,8]
des[1,9] <- df[38,8]
if(df[56,8]=="YES"){
des[1,10] <- "No tumour"
}
if(df[57,8]=="YES"){
des[1,10] <- "Squamous cell carcinoma"
}
if(df[58,8]=="YES"){
des[1,10] <- "Adenocarcinoma"
}
if(is.na(df[59,8])==F){
des[1,10] <- df[59,8]
}
if(df[61,8]=="YES"){
des[1,11] <- "Well"
}
if(df[62,8]=="YES"){
des[1,11] <- "Moderate"
}
if(df[63,8]=="YES"){
des[1,11] <- "Poor"
}
des[1,12] <-
des[1,13] <- df[101,8]
des[1,14] <- df[102,8]
for(i in 1:5){
if(isTRUE(df[132+i,8]=="Yes")){
des[1,15]<-i
}
}
for(i in 1:5){
if(isTRUE(df[132+i,8]=="YES")){
des[1,15]<-i
}
}
for(i in 1:8){
if(df[66+i,8]=="YES"){
des[1,12] <- df[66+i,7]
}
}
library(readxl)
library(openxlsx)
library(tidyverse)
R.Version()
library(installr)
updateR()
library(readxl)
library(openxlsx)
library(tidyverse)
import.mult.datasets<-function(path){
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
setwd(path)
path_wd<-getwd()
nom<-dir(path_wd)
df<-list(mode="vector",length=length(nom))
for(i in 1:length(nom)){
df[[i]]<-read_xls(nom[i])[,c(1,3:9)]
}
for(i in 1:length(nom)){
des[i,1] <- df[[i]][2,8]
des[i,2] <- paste("UGI-",df[[i]][1,8],sep="")
des[i,3] <- df[[i]][7,8]
for(j in 1:4){
if(is.na(df[[i]][10+j,8])==F){
des[i,4] <- df[[i]][10+j,7]
}
}
des[i,5] <- df[[i]][20,8]
des[i,6] <- df[[i]][21,8]
if(is.na(df[[i]][28,8])==F){
des[i,7] <- "Entire circumference"
}
if(is.na(df[[i]][29,8])==F){
des[i,7] <- "Anterior/Posterior"
}
if(is.na(df[[i]][30,8])==F){
des[i,7] <- "Right/left"
}
if(is.na(df[[i]][31,8])==F){
des[i,7] <- "Unknown"
}
des[i,8] <- df[[i]][37,8]
des[i,9] <- df[[i]][38,8]
for(j in 1:3){
if(is.na(df[[i]][55+j,8])==F){
des[i,10] <- df[[i]][55+j,7]
}
}
if(is.na(df[[i]][59,8])==F){
des[i,10] <- df[[i]][59,8]
}
for(j in 1:3){
if(is.na(df[[i]][60+j,8])==F){
des[i,11] <- df[[i]][60+j,7]
}
}
for(j in 1:8){
if(is.na(df[[i]][66+j,8])==F){
des[i,12] <- df[[i]][66+j,7]
}
}
des[i,13] <- df[[i]][101,8]
des[i,14] <- df[[i]][102,8]
for(j in 1:5){
if(is.na(df[[i]][132+j,8])==F){
des[i,15]<-j
}
}
}
des
}
test<-import.mult.datasets("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/OE05/CentralPathRevs")
a<-c("Unknown",NA,"Anything","unknown","Lit")
b<-rep(0,5)
for(i in 1:5){
if(str_detect(a[i],regex("unknown",ignore_case = TRUE))){
b<-1
else if(is.na(a[i])==F){
b<-2
}
}
}
for(i in 1:5){
if(str_detect(a[i],regex("unknown",ignore_case = TRUE))){
b<-1
}
else if(is.na(a[i])==F){
b<-2
}
}
for(i in 1:5){
if(str_detect(a[i],regex("unknown",ignore_case = TRUE))==T){
b<-1
}
else if(is.na(a[i])==F){
b<-2
}
}
for(i in 1:5){
for(i in 1:5){
}
}
for(i in 1:5){
b<-1
if(isTRUE(str_detect(a[i],regex("unknown",ignore_case = TRUE))){
b<-1
}
else if(is.na(a[i])==F){
b<-2
}
}
for(i in 1:5){
if(isTRUE(str_detect(a[i],regex("unknown",ignore_case = TRUE))){
b<-1
}
else if(is.na(a[i])==F){
b<-2
}
}
for(i in 1:5){
if(isTRUE(str_detect(a[i],regex("unknown",ignore_case = TRUE))){
b<-1
}
else if(is.na(a[i])==F){
b<-2
}
}
for(i in 1:5){
if(isTRUE(str_detect(a[i],regex("unknown",ignore_case = TRUE)))){
b<-1
}
else if(is.na(a[i])==F){
b<-2
}
}
for(i in 1:5){
if(isTRUE(str_detect(a[i],regex("unknown",ignore_case = TRUE)))){
b[i]<-1
}
else if(is.na(a[i])==F){
b[i]<-2
}
}
import.mult.datasets<-function(path){
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
setwd(path)
path_wd<-getwd()
nom<-dir(path_wd)
df<-list(mode="vector",length=length(nom))
for(i in 1:length(nom)){
df[[i]]<-read_xls(nom[i])[,c(1,3:9)]
}
for(i in 1:length(nom)){
des[i,1] <- df[[i]][2,8]
des[i,2] <- paste("UGI-",df[[i]][1,8],sep="")
des[i,3] <- df[[i]][7,8]
for(j in 1:4){
if(isTRUE(str_detect(df[[i]][10+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,4] <- "Unknown"
}
else if(is.na(df[[i]][10+j,8])==F){
des[i,4] <- df[[i]][10+j,7]
}
}
des[i,5] <- df[[i]][20,8]
des[i,6] <- df[[i]][21,8]
for(j in 1:4){
if(isTRUE(str_detect(df[[i]][27+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,7] <- "Unknown"
}
else if(is.na(df[[i]][28,8])==F){
des[i,7] <- "Entire circumference"
}
else if(is.na(df[[i]][29,8])==F){
des[i,7] <- "Anterior/Posterior"
}
else if(is.na(df[[i]][30,8])==F){
des[i,7] <- "Right/left"
}
else if(is.na(df[[i]][31,8])==F){
des[i,7] <- "Unknown"
}
}
des[i,8] <- df[[i]][37,8]
des[i,9] <- df[[i]][38,8]
for(j in 1:3){
if(is.na(df[[i]][55+j,8])==F){
des[i,10] <- df[[i]][55+j,7]
}
}
if(is.na(df[[i]][59,8])==F){
des[i,10] <- df[[i]][59,8]
}
for(j in 1:3){
if(is.na(df[[i]][60+j,8])==F){
des[i,11] <- df[[i]][60+j,7]
}
}
for(j in 1:8){
if(is.na(df[[i]][66+j,8])==F){
des[i,12] <- df[[i]][66+j,7]
}
}
des[i,13] <- df[[i]][101,8]
des[i,14] <- df[[i]][102,8]
for(j in 1:5){
if(is.na(df[[i]][132+j,8])==F){
des[i,15]<-j
}
}
}
des
}
test<-import.mult.datasets("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/OE05/CentralPathRevs")
import.mult.datasets<-function(path){
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
setwd(path)
path_wd<-getwd()
nom<-dir(path_wd)
df<-list(mode="vector",length=length(nom))
for(i in 1:length(nom)){
df[[i]]<-read_xls(nom[i])[,c(1,3:9)]
}
for(i in 1:length(nom)){
des[i,1] <- df[[i]][2,8]
des[i,2] <- paste("UGI-",df[[i]][1,8],sep="")
des[i,3] <- df[[i]][7,8]
for(j in 1:4){
if(isTRUE(str_detect(df[[i]][10+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,4] <- "Unknown"
}
else if(is.na(df[[i]][10+j,8])==F){
des[i,4] <- df[[i]][10+j,7]
}
}
des[i,5] <- df[[i]][20,8]
des[i,6] <- df[[i]][21,8]
for(j in 1:4){
if(isTRUE(str_detect(df[[i]][27+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,7] <- "Unknown"
}
else if(is.na(df[[i]][28,8])==F){
des[i,7] <- "Entire circumference"
}
else if(is.na(df[[i]][29,8])==F){
des[i,7] <- "Anterior/Posterior"
}
else if(is.na(df[[i]][30,8])==F){
des[i,7] <- "Right/left"
}
else if(is.na(df[[i]][31,8])==F){
des[i,7] <- "Unknown"
}
}
des[i,8] <- df[[i]][37,8]
des[i,9] <- df[[i]][38,8]
for(j in 1:3){
if(isTRUE(str_detect(df[[i]][55+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,10] <- "Unknown"
}
else if(is.na(df[[i]][55+j,8])==F){
des[i,10] <- df[[i]][55+j,7]
}
}
if(is.na(df[[i]][59,8])==F){
des[i,10] <- df[[i]][59,8]
}
for(j in 1:3){
if(isTRUE(str_detect(df[[i]][60+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,11] <- "Unknown"
}
if(is.na(df[[i]][60+j,8])==F){
des[i,11] <- df[[i]][60+j,7]
}
}
for(j in 1:8){
if(isTRUE(str_detect(df[[i]][66+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,12] <- "Unknown"
}
if(is.na(df[[i]][66+j,8])==F){
des[i,12] <- df[[i]][66+j,7]
}
}
des[i,13] <- df[[i]][101,8]
des[i,14] <- df[[i]][102,8]
for(j in 1:5){
if(isTRUE(str_detect(df[[i]][132+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,15] <- "Unknown"
}
if(is.na(df[[i]][132+j,8])==F){
des[i,15]<-j
}
}
}
des
}
test<-import.mult.datasets("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/OE05/CentralPathRevs")
import.mult.datasets<-function(path){
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
setwd(path)
path_wd<-getwd()
nom<-dir(path_wd)
df<-list(mode="vector",length=length(nom))
for(i in 1:length(nom)){
df[[i]]<-read_xls(nom[i])[,c(1,3:9)]
}
for(i in 1:length(nom)){
des[i,1] <- df[[i]][2,8]
des[i,2] <- paste("UGI-",df[[i]][1,8],sep="")
des[i,3] <- df[[i]][7,8]
for(j in 1:4){
if(isTRUE(str_detect(df[[i]][10+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,4] <- "Unknown"
}
else if(is.na(df[[i]][10+j,8])==F){
des[i,4] <- df[[i]][10+j,7]
}
}
des[i,5] <- df[[i]][20,8]
des[i,6] <- df[[i]][21,8]
for(j in 1:4){
if(isTRUE(str_detect(df[[i]][27+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,7] <- "Unknown"
}
else if(is.na(df[[i]][28,8])==F){
des[i,7] <- "Entire circumference"
}
else if(is.na(df[[i]][29,8])==F){
des[i,7] <- "Anterior/Posterior"
}
else if(is.na(df[[i]][30,8])==F){
des[i,7] <- "Right/left"
}
else if(is.na(df[[i]][31,8])==F){
des[i,7] <- "Unknown"
}
}
des[i,8] <- df[[i]][37,8]
des[i,9] <- df[[i]][38,8]
for(j in 1:3){
if(isTRUE(str_detect(df[[i]][55+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,10] <- "Unknown"
}
else if(is.na(df[[i]][55+j,8])==F){
des[i,10] <- df[[i]][55+j,7]
}
}
if(is.na(df[[i]][59,8])==F){
des[i,10] <- df[[i]][59,8]
}
for(j in 1:3){
if(isTRUE(str_detect(df[[i]][60+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,11] <- "Unknown"
}
else if(is.na(df[[i]][60+j,8])==F){
des[i,11] <- df[[i]][60+j,7]
}
}
for(j in 1:8){
if(isTRUE(str_detect(df[[i]][66+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,12] <- "Unknown"
}
else if(is.na(df[[i]][66+j,8])==F){
des[i,12] <- df[[i]][66+j,7]
}
}
des[i,13] <- df[[i]][101,8]
des[i,14] <- df[[i]][102,8]
for(j in 1:5){
if(isTRUE(str_detect(df[[i]][132+j,8],regex("unknown",ignore_case = TRUE)))){
des[i,15] <- "Unknown"
}
else if(is.na(df[[i]][132+j,8])==F){
des[i,15]<-j
}
}
}
des
}
test<-import.mult.datasets("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/OE05/CentralPathRevs")
test<-import.mult.datasets("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/OE05/UGI_OE05_PATHREVIEW_V3")
test<-import.mult.datasets("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/OE05/CentralPathRevs")
View(test)
setwd("~/BeCurious/BeCurious_ACNO")
setwd("~/GitHub/BeCurious")
knitr::opts_chunk$set(echo = TRUE)
data<-read.csv('Be curious 2022 participant data.csv')
data<-read.csv('Be curious 2022 participant data.csv')
data$Colour<-as.factor(data$Colour)
data$Group<-as.factor(data$Group)
data$How.Happy.Are.You.<-factor(data$How.Happy.Are.You., ordered=TRUE, labels=c("Not Happy","Happy","Very Happy"))
OverallPlotData <- data.frame(table(data$Group, data$How.Happy.Are.You.))
colnames(OverallPlotData) <- c("Chocolate Group", "Happy", "Freq")
library(ggplot2)
library(scales)
library(grid)
library(gridExtra)
library(tidyr)
OverallPlot <- ggplot(OverallPlotData, aes(fill=`Chocolate Group`, x=Happy, y=Freq)) +
geom_bar(position="dodge", stat="identity") + theme_minimal() + theme(plot.title = element_text(size = 12,hjust=0.5)) +
scale_fill_brewer(palette="Paired") +
geom_text(aes(label=Freq), vjust=1.6, color="white", position = position_dodge(0.9), size=3.5) +
labs(title="Current Happiness by Chocolate Groups", x="Current Happiness", y="Number of Participants")
tt3 <- ttheme_minimal(
core=list(bg_params = list(fill = blues9[1:4], col=NA),
fg_params=list(fontface=3)),
colhead=list(bg_params = list(fill = "navyblue", col=NA),
fg_params=list(col="white", fontface=4L)),
rowhead=list(fg_params=list(col="white", fontface=3L)))
table<-spread(OverallPlotData,key=Happy,value=Freq)
table[,4]<-
tbl <- tableGrob(table, theme=tt3)
