setdiff(sort(trialno_mg$trialnumber),sort(JL_unique$trialnumber))
setdiff(sort(trialno_mg$trialnumber),sort(orig_data$trialnumber))
View(trialno_mg)
#find all pts within original dataset that aren't in John's
setdiff(sort(orig_data$trialnumber),sort(trialno_mg$trialnumber))
trialno_mg_uq <- trialno_mg[!duplicated(trialno_mg$trialnumber),]
View(JL_unique_biopsy)
trialno_mg_dups <- trialno_mg[duplicated(trialno_mg$trialnumber),]
View(trialno_mg_dups)
trialno_mg_dups <- trialno_mg[duplicated(trialno_mg$trialnumber),1]
#find all pts within original dataset that aren't in John's
setdiff(sort(orig_data$trialnumber),sort(COG_unique$trialnumber))
orig_data <- read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/COG/COG_all_data_12112021.xlsx")
orig_data$trialnumber <- str_remove(orig_data$trialnumber,"CG")
jon_data <- read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/COG/TRANSCOG inventory for Jake.xlsx")[,-c(5,7)]
jon_data <- jon_data[-c(which(jon_data$Specimen.Category=="?")),]
#number of unique CG numbers in trial (trialno in orig_data)
JL_unique_cg <- jon_data[!duplicated(jon_data$CG.number),]
JL_unique_tc_prelim <- jon_data[!duplicated(jon_data$TC.number),]
JL_unique_tc <- spread(JL_unique_tc_prelim,Specimen.Category,TC.number)
JL_TC_bx <- JL_unique_tc[which(is.na(JL_unique_tc$Biopsy)==F),c(1,3,5)]
JL_TC_res <- JL_unique_tc[which(is.na(JL_unique_tc$Resection)==F),c(1,3,6)]
JL_TC_all <- merge(JL_TC_bx,JL_TC_res, by="CG.number", all=T)
JL_TC_all <- JL_TC_all[-c(which(JL_TC_all$CG.number=="?")),]
names(JL_TC_all)<-c("trialnumber","UGI_no_bx","TC_no_bx", "UGI_no_res", "TC_no_res")
COG_all_prelim <- merge(orig_data, JL_TC_all, by="trialnumber")
COG_unique <- COG_all_prelim[!duplicated(COG_all_prelim$trialnumber),]
COG_dups <- trialno_mg[duplicated(COG_all_prelim$trialnumber),1]
#find all pts within original dataset that aren't in John's
setdiff(sort(orig_data$trialnumber),sort(COG_unique$trialnumber))
# "1050" "1087" "1154" "1197" "1221" "1237" "1383" "1403" "1427" "1430"
setdiff(sort(JL_TC_all$trialnumber),sort(COG_unique$trialnumber))
View(orig_data)
View(jon_data)
View(jon_data)
View(COG_all_prelim)
View(COG_unique)
#Check match of TransCOG number from original data to Jon's values
COG_all_prelim$TC_check <- 0
COG_all_prelim$TC_check[which(COG_all_prelim$transcognumber==COG_all_prelim$TC_no_bx|
COG_all_prelim$transcognumber==COG_all_prelim$TC_no_res)] <- 1
sum(COG_all_prelim$TC_check)
COG_TC_check <- COG_all_prelim[which(COG_all_prelim$TC_check==0),]
View(COG_all_prelim)
COG_TC_check <- COG_all_prelim[which(COG_all_prelim$TC_check==0),c(1,2,46,48)]
View(COG_TC_check)
COG_all_prelim$TC_check2 <- 0
COG_all_prelim$TC_check2[which(str(COG_all_prelim$transcognumber,-5,-1)==str(COG_all_prelim$TC_no_bx,-5,-1)|
str(COG_all_prelim$transcognumber,-5,-1)==str(COG_all_prelim$TC_no_res,-5,-1))] <- 1
str(COG_all_prelim$transcognumber,-5,-1)
COG_all_prelim$TC_check2[which(str_sub(COG_all_prelim$transcognumber,-5,-1)==str_sub(COG_all_prelim$TC_no_bx,-5,-1)|
str_sub(COG_all_prelim$transcognumber,-5,-1)==str_sub(COG_all_prelim$TC_no_res,-5,-1))] <- 1
COG_all_prelim$transcognumber,-5,-1)
str_sub(COG_all_prelim$transcognumber,-5,-1)
str_sub(COG_all_prelim$transcognumber,1,5)
COG_all_prelim$TC_check2[which(str_sub(COG_all_prelim$transcognumber,1,5)==str_sub(COG_all_prelim$TC_no_bx,1,5)|
str_sub(COG_all_prelim$transcognumber,1,5)==str_sub(COG_all_prelim$TC_no_res,1,5))] <- 1
#315
sum(COG_all_prelim$TC_check2)
COG_TC_check <- COG_all_prelim[which(COG_all_prelim$TC_check==0),c(1,2,46,48)]
COG_TC_check2 <- COG_all_prelim[which(COG_all_prelim$TC_check2==0),c(1,2,46,48)]
View(COG_TC_check2)
View(orig_data)
install.packages(haven)
install.packages("haven")
library(haven)
df<-read_sas('P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/SASdata/COG/cog_all.sas7bdat')
View(df)
df<-read_sas('P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/SASdata/COG/cog_all.sas7bdat',
'P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/SASformats/COG/formats.sas7bcat')
library(haven)
df<-read_sas('P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/SASdata/COG/cog_all.sas7bdat',
'P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/SASformats/COG/formats.sas7bcat')
View(df)
attributes(df$fishcat)
test<-names(attr(df[,'fishcat'],'labels'))
test<-names(attr(df[,'fishcat'], 'labels')[df[, 'fishcat']])
names(attr(df[,'fishcat'], 'labels')[df[, 'fishcat']])
test<-table(names(attr(df[,'fishcat'], 'labels')[df[, 'fishcat']]),
names(attr(df[, 'egfr19'], 'labels')[df[, 'egfr19']]))
test<-table(names(attr(df[,'fishcat'], 'labels')[df[, 'fishcat']]),
names(attr(df[, 'EGFR19'], 'labels')[df[, 'EGFR19']]))
test
attr(df[,'fishcat'], 'labels')
df[,'fishcat']
lm(ageatrand~fishcat,data=df)
summary(lm(ageatrand~fishcat,data=df))
class(df$fishcat)
summary(df[,3])
View(df[,1])
View(df[,3])
View(df[,3]$labels)
attributes(df$fishcat)
df$fishcat$labels
sas <- read_sas('C:/Documents/nats2012.sas7bdat', 'C:/Documents/formats.sas7bcat')
sas <- read_sas('Documents/nats2012.sas7bdat', 'Documents/formats.sas7bcat')
sas <- read_sas('C:/Users/medjemm/Documents/nats2012.sas7bdat', 'C:/Users/medjemm/Documents/formats.sas7bcat')
with(sas, table(SMOKSTATUS_R, RACEETHNIC))
table(names(attr(sas[, 'SMOKSTATUS_R'], 'labels')[sas[, 'SMOKSTATUS_R']]),
names(attr(sas[, 'RACEETHNIC'], 'labels')[sas[, 'RACEETHNIC']]))
attr(sas[, 'SMOKSTATUS_R'], 'labels')
sas[, 'SMOKSTATUS_R']
sas[, 'SMOKSTATUS_R']$labels
sas[, 'SMOKSTATUS_R'][,labels]
sas[, 'SMOKSTATUS_R'][labels]
sas <- read_sas('C:/Users/medjemm/Documents/nats2012.sas7bdat', 'C:/Users/medjemm/Documents/formats.sas7bcat',encoding=labels)
sas <- read_sas('C:/Users/medjemm/Documents/nats2012.sas7bdat', 'C:/Users/medjemm/Documents/formats.sas7bcat',encoding=1)
sas <- read_sas('C:/Users/medjemm/Documents/nats2012.sas7bdat', 'C:/Users/medjemm/Documents/formats.sas7bcat',encoding='labels')
class(df)
class(names(df))
summary(df)
names(attr(sas[, 'SMOKSTATUS_R'], 'labels')[sas[, 'SMOKSTATUS_R']])
attr(sas[, 'SMOKSTATUS_R'], 'labels')
summary(df[,3])
attributes(df$fishcat)
df[,3]$labels
df[,3]$label
class(df$fishcat)
View(df$fishcat_labelled)
print_labels(df$fishcat)
class(df)
class(tbl_df)
'labels'
contents(df[,3])
labels(df$fishcat)
library(Hmisc)
library(tidyverse)
table(names(attr(sas[, 'SMOKSTATUS_R'], 'labels')[sas[, 'SMOKSTATUS_R']]),
names(attr(sas[, 'RACEETHNIC'], 'labels')[sas[, 'RACEETHNIC']]))
class(df$progdate)
library(openxlsx)
cog<-read.xlsx('P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/Output/COG/COG_alldata_18032022.xlsx')
View(cog)
summary(cog)
cog_edit<-apply(cog[,c(3:11,13:21,25:26,28,30,32,36,38:39,42,44)],as.factor)
cog_edit<-apply(cog,cog[,c(3:11,13:21,25:26,28,30,32,36,38:39,42,44)],as.factor)
cog_edit<-apply(cog[,c(3:11,13:21,25:26,28,30,32,36,38:39,42,44)],2,as.factor)
View(cog_edit)
class(cog_edit)
cog_edit<-as.data.frame(cog_edit)
summary(cog_edit)
class(cog_edit,fishcat)
class(cog_edit$fishcat)
cog_edit<-lapply(cog[,c(3:11,13:21,25:26,28,30,32,36,38:39,42,44)],factor)
View(cog_edit)
cog[,c(3:11,13:21,25:26,28,30,32,36,38:39,42,44)] <- lapply(cog[,c(3:11,13:21,25:26,28,30,32,36,38:39,42,44)],factor)
View(cog)
summary(cog)
df[1,22]
df[1,22]-df[2-22]
df[1,22]-df[2,22]
cog[,22:24,27,29,31,33:35,40,43] <- lapply(cog[,22:24,27,29,31,33:35,40,43],date)
cog[,c(22:24,27,29,31,33:35,40,43)] <- lapply(cog[,c(22:24,27,29,31,33:35,40,43)],date)
cog[,c(22:24,27,29,31,33:35,40,43)] <- lapply(cog[,c(22:24,27,29,31,33:35,40,43)],as.date)
cog[,c(22:24,27,29,31,33:35,40,43)] <- lapply(cog[,c(22:24,27,29,31,33:35,40,43)],as.Date)
cog[,c(22:24,27,29,31,33:35,40,43)] <- df[,c(22:24,27,29,31,33:35,40,43)]
View(cog)
print_labels(df)
print_labels(df$fishcat)
as_label(df$fishcat)
get_labels(df$fishcat)
df1<-df
df1$fishcat<-as.factor(df1$fishcat)
summary(lm(ageatrand~fishcat))
summary(lm(ageatrand~fishcat,data=df1))
install.packages("sjmisc")
library(sjmisc)
get_labels(df$fishcat)
install.packages("sjlabelled")
library(sjlabelled)
get_labels(df$fishcat)
get_labels(summary(lm(ageatrand~fishcat,data=df1)))
df1<-df
to_factor(df1$fishcat)
class(df1$fishcat)
df1$fishcat<-to_factor(df1$fishcat)
class(df1$fishcat)
summary(df1$fishcat)
head(df1$fishcat)
df1$fishcat<-to_factor(df1$fishcat,levels="df1$fishcat")
class(df1$fishcat)
head(df1$fishcat)
df1<-df
(df1$fishcat)
to_factor(df1$fishcat)
v <- labelled(c(1,2,2,2,3,9,1,3,2,NA), c(yes = 1, no = 3, "don't know" = 8, refused = 9))
install.packages("labelled")
library(labelled)
v <- labelled(c(1,2,2,2,3,9,1,3,2,NA), c(yes = 1, no = 3, "don't know" = 8, refused = 9))
to_factor(v)
df1<-df
df1$fishcat<-to_factor(df1$fishcat)
class(df1$fishcat)
head(df1$fishcat)
lm(ageatrand~fishcat,data=df1)
summary(lm(ageatrand~fishcat,data=df1))
summary(cog)
df1$EGFR19<-to_factor(df1$EGFR19)
summary(lm(ageatrand~EGFR19,data=df1))
levels(df1$EGFR19)
libary(labelled)
library(haven)
library(openxlsx)
library(labelled)
df<-read_sas('P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/SASdata/COG/cog_all.sas7bdat',
'P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/09_Analysis/SASformats/COG/formats.sas7bcat')
df[,c(3:11,13:21)] <- lapply(df[,c(3:11,13:21)], to_factor)
View(df)
df[,c(25:26,28,30,32,36,38:39,42)] <- lapply(df[,c(25:26,28,30,32,36,38:39,42)], factor)
library(openxlsx)
library(tidyverse)
read.xlsx("P:\CTRU\Projects\Cancer\Colorectal\UGI-HE-TIL\Stats\08_TrialData\ST03\UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")
read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")
read.xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")
install.packages("gdata")
library(gdata)
read.xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")
read.xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")
read.xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls",perl="perl")
library(readxl)
read_xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")
df<-read_xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")
View(df)
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
View(des)
des[1,1] <- df[2,9]
des[1,2] <- paste("UGI-",df[1,9])
des[1,2] <- paste("UGI-",df[1,9],sep="")
des[1,3] <- df[7,9]
df <- read_xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")[,c(1,3:9)]
library(readxl)
library(openxlsx)
library(tidyverse)
df <- read_xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")[,c(1,3:9)]
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
des[1,1] <- df[2,8]
des[1,2] <- paste("UGI-",df[1,8],sep="")
des[1,3] <- df[7,8]
des[1,4] <-
des[1,5] <- df[20,8]
des[1,6] <- df[21,8]
des[1,7] <-
des[1,8] <- df[37,8]
des[1,9] <- df[38,8]
des[1,10] <-
des[1,11] <-
des[1,12] <-
des[1,13] <- df[101,8]
des[1,14] <- df[102,8]
install.packages(c("broom", "caret", "cli", "clipr", "colorspace", "commonmark", "conquer", "crayon", "dplyr", "DT", "evaluate", "foreach", "future", "generics", "glue", "gower", "insight", "iterators", "jsonlite", "lme4", "magrittr", "maptools", "mathjaxr", "nloptr", "openssl", "pillar", "quantreg", "Rcpp", "RCurl", "readr", "recipes", "rlang", "rmarkdown", "survival", "tidyr", "tidyselect", "tinytex", "uuid", "withr", "xfun", "yaml"))
install.packages(c("MASS", "mgcv", "survival"), lib="C:/Users/medjemm/Documents/R/R-4.1.2/library")
if(df[11,9]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[12,9]=="YES"){
des[1,4] <- "Total oesophagectomy"
}
if(df[13,9]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
if(df[14,9]=="YES"){
des[1,4] <- "Unknown"
}
if(df[11,9]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[12,9]=="YES"){
des[1,4] <- "Total oesophagectomy"
}
if(df[13,9]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
if(df[14,9]=="YES"){
des[1,4] <- "Unknown"
}
if(df[11,9]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[12,9]=="YES"){
des[1,4] <- "Total oesophagectomy"
}
if(df[13,9]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
if(df[14,9]=="YES"){
des[1,4] <- "Unknown"
}
des[1,5] <- df[20,8]
install.packages("broom")
install.packages(c("caret", "cli", "clipr"))
install.packages(c("caret", "cli", "clipr"))
install.packages(c("caret", "cli", "clipr"))
install.packages(c("caret", "cli", "clipr"))
install.packages(c("caret", "cli"))
install.packages(c("caret", "cli"))
install.packages(c("caret", "cli"))
install.packages(c("caret", "cli"))
install.packages(c("colorspace", "commonmark", "conquer", "crayon", "dplyr"))
install.packages(c("withr", "xfun", "yaml"))
install.packages(c("MASS", "mgcv", "survival"), lib="C:/Users/medjemm/Documents/R/R-4.1.2/library")
install.packages(c("readr", "recipes", "rmarkdown", "survival", "tidyr", "tidyselect", "tinytex", "uuid"))
install.packages(c("magrittr", "maptools", "mathjaxr", "nloptr", "openssl", "pillar", "quantreg", "Rcpp", "RCurl"))
install.packages(c("future", "generics", "glue", "gower", "insight", "iterators", "jsonlite", "lme4"))
install.packages(c("DT", "evaluate", "foreach"))
install.packages("cli")
install.packages("cli")
install.packages("clipr")
if(df[11,9]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[11,9]="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
df[11, 9] == "YES"
isTRUE(df[11, 9] == "YES")
df[11, 9]
if(df[13,9]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
df[13,9]
if(df[11,8]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
isTRUE(df[11, 9] == "YES")
isTRUE(df[13, 8] == "YES")
df[13, 8] == "YES"
if(df[11,8]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[12,8]=="YES"){
des[1,4] <- "Total oesophagectomy"
}
if(df[13,8]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
if(df[14,8]=="YES"){
des[1,4] <- "Unknown"
}
for(i in 1:5){
if(df[132+i,8]=="Yes"){
des[1,15]<-i
}
}
for(i in 1:5){
if(isTRUE(df[132+i,8]=="Yes")){
des[1,15]<-i
}
}
if(df[133,8]=="YES"){
des[1,15] <- 1
}
if(df[133,8]=="YES"){
des[1,15] <- 1
}
if(df[133,8]=="YES"){
des[1,15] <- 1
}
if(df[133,8]=="YES"){
des[1,15] <- 1
}
if(df[133,8]=="YES"){
des[1,15] <- 1
}
if(df[133,8]=="YES"){
des[1,15] <- 1
}
df <- read_xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")[,c(1,3:9)]
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
des[1,1] <- df[2,8]
des[1,2] <- paste("UGI-",df[1,8],sep="")
des[1,3] <- df[7,8]
if(df[11,8]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[12,8]=="YES"){
des[1,4] <- "Total oesophagectomy"
}
if(df[13,8]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
if(df[14,8]=="YES"){
des[1,4] <- "Unknown"
}
des[1,5] <- df[20,8]
des[1,6] <- df[21,8]
if(df[28,8]=="YES"){
des[1,7] <- "Entire circumference"
}
if(df[29,8]=="YES"){
des[1,7] <- "Anterior/Posterior"
}
if(df[30,8]=="YES"){
des[1,7] <- "Right/left"
}
if(df[31,8]=="YES"){
des[1,7] <- "Unknown"
}
des[1,8] <- df[37,8]
des[1,9] <- df[38,8]
if(df[56,8]=="YES"){
des[1,10] <- "No tumour"
}
if(df[57,8]=="YES"){
des[1,10] <- "Squamous cell carcinoma"
}
if(df[58,8]=="YES"){
des[1,10] <- "Adenocarcinoma"
}
if(is.na(df[59,8])==F){
des[1,10] <- df[59,8]
}
if(df[61,8]=="YES"){
des[1,11] <- "Well"
}
if(df[62,8]=="YES"){
des[1,11] <- "Moderate"
}
if(df[63,8]=="YES"){
des[1,11] <- "Poor"
}
des[1,12] <-
des[1,13] <- df[101,8]
des[1,14] <- df[102,8]
for(i in 1:5){
if(isTRUE(df[132+i,8]=="Yes")){
des[1,15]<-i
}
}
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
library(readxl)
library(openxlsx)
library(tidyverse)
df <- read_xls("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/UGI_0547_OE05_ PATHREVIEW_V3_SP_082015.xls")[,c(1,3:9)]
des <-  read.xlsx("P:/CTRU/Projects/Cancer/Colorectal/UGI-HE-TIL/Stats/08_TrialData/ST03/ST03_res_pathcentralrevformat_22032022.xlsx")
des[1,1] <- df[2,8]
des[1,2] <- paste("UGI-",df[1,8],sep="")
des[1,3] <- df[7,8]
if(df[11,8]=="YES"){
des[1,4] <- "Ivor-Lewis oesophagectomy"
}
if(df[12,8]=="YES"){
des[1,4] <- "Total oesophagectomy"
}
if(df[13,8]=="YES"){
des[1,4] <- "Gastro-oesophagectomy"
}
if(df[14,8]=="YES"){
des[1,4] <- "Unknown"
}
des[1,5] <- df[20,8]
des[1,6] <- df[21,8]
if(df[28,8]=="YES"){
des[1,7] <- "Entire circumference"
}
if(df[29,8]=="YES"){
des[1,7] <- "Anterior/Posterior"
}
if(df[30,8]=="YES"){
des[1,7] <- "Right/left"
}
if(df[31,8]=="YES"){
des[1,7] <- "Unknown"
}
des[1,8] <- df[37,8]
des[1,9] <- df[38,8]
if(df[56,8]=="YES"){
des[1,10] <- "No tumour"
}
if(df[57,8]=="YES"){
des[1,10] <- "Squamous cell carcinoma"
}
if(df[58,8]=="YES"){
des[1,10] <- "Adenocarcinoma"
}
if(is.na(df[59,8])==F){
des[1,10] <- df[59,8]
}
if(df[61,8]=="YES"){
des[1,11] <- "Well"
}
if(df[62,8]=="YES"){
des[1,11] <- "Moderate"
}
if(df[63,8]=="YES"){
des[1,11] <- "Poor"
}
des[1,12] <-
des[1,13] <- df[101,8]
des[1,14] <- df[102,8]
for(i in 1:5){
if(isTRUE(df[132+i,8]=="Yes")){
des[1,15]<-i
}
}
for(i in 1:5){
if(isTRUE(df[132+i,8]=="YES")){
des[1,15]<-i
}
}
for(i in 1:8){
if(df[66+i,8]=="YES"){
des[1,12] <- df[66+i,7]
}
}
library(readxl)
library(openxlsx)
library(tidyverse)
R.Version()
library(installr)
updateR()
setwd("~/GitHub/BeCurious")
